<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <!-- Ensures proper scaling on smartphones -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Purple Labyrinth Text Adventure</title>
  <style>
    /* Base page styling */
    body {
      background-color: #000;
      color: purple;
      font-family: "Courier New", Courier, monospace;
      margin: 0;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
    }
    /* Game container: fixed at 630x980 (70% of 900x1400) */
    #game-container {
      position: relative;
      width: 630px;
      height: 980px;
      max-width: 100%;
      max-height: 100%;
      padding: 20px;
      border: 2px solid purple;
      background-color: #000;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }
    /* Particle canvas covers the entire container behind all content */
    #particleCanvas {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 0;
    }
    /* Header container occupies the top 33% of the game container */
    #header-container {
      flex: 0 0 33%;
      overflow: visible;
      position: relative;
      z-index: 1;
    }
    /* Your provided ASCII art styling; override the font-size to 4.5px so the full art fits */
    #tiresult {
      font-size: 4.5px !important;
      background-color: transparent;
      font-weight: bold;
      padding: 4px 5px;
      --fs: 9px;
      color: purple;
      white-space: pre;
      margin: 0;
    }
    /* Narrative text styling */
    #text {
      white-space: pre-wrap;
      line-height: 1.5;
      min-height: 200px;
      width: 100%;
      margin: 10px 0;
      position: relative;
      z-index: 1;
      color: purple;
    }
    /* Choices styling */
    #choices {
      width: 100%;
      margin-bottom: 10px;
      white-space: pre-wrap;
      position: relative;
      z-index: 1;
      color: purple;
    }
    /* Input container styling */
    #input-container {
      width: 100%;
      display: flex;
      align-items: center;
      font-size: 1.1em;
      position: relative;
      z-index: 1;
      /* Initially hidden until choices are finished animating */
      display: none;
    }
    /* Blinking prompt indicator */
    #prompt {
      margin-right: 5px;
      animation: blink 1s step-start infinite;
    }
    @keyframes blink {
      0% { opacity: 1; }
      50% { opacity: 0; }
      100% { opacity: 1; }
    }
    /* Input field styling */
    #command-input {
      background: none;
      border: none;
      outline: none;
      color: purple;
      font-family: inherit;
      font-size: inherit;
      flex: 1;
    }
  </style>
</head>
<body>
  <div id="game-container">
    <!-- Particle effect canvas behind all content -->
    <canvas id="particleCanvas"></canvas>
    
    <!-- Header container for the ASCII art -->
    <div id="header-container">
      <!DOCTYPE html>
<html lang="en">
<head>
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ASCII Multiâ€‘Step Glitch per Line</title>
  <style>
    body {
      background: #000;
      font-family: monospace;
      margin: 0;
      padding: 20px;
      margin: 0 auto; 
      text-align: center;
    }
    /* The container for the ASCII art */
    #tiresult {
      font-size: 9px;
      background-color: #000;
      font-weight: bold;
      padding: 4px 5px;
      color: #E6E6E6;

      /* Keep each line as a single horizontal row */
      white-space: pre;
      overflow-x: auto;
    }
    /* Each logical line is wrapped in a .line div */
    .line {
      display: block;
      white-space: nowrap;
      position: relative;
      /* 20-second cycle, infinite repeats */
      animation-duration: 30s;
      animation-iteration-count: infinite;
      animation-timing-function: linear;

    }
    /* Alternate glitch directions per line */
    .line:nth-child(odd) {
      animation-name: glitch-right;
    }
    .line:nth-child(even) {
      animation-name: glitch-left;
     }
    /* Glitch burst: a series of rapid horizontal shifts lasting ~1 second
       (from 50% to 53% of the 30s cycle) */
    @keyframes glitch-right {
      0%, 50%, 53%, 100% { transform: translateX(0); }
      50.5% { transform: translateX(10px); }
      50.7% { transform: translateX(-10px); }
      50.9% { transform: translateX(8px); }
      51.1% { transform: translateX(-8px); }
      51.3% { transform: translateX(6px); }
      51.5% { transform: translateX(-6px); }
      51.7% { transform: translateX(4px); }
      51.9% { transform: translateX(-4px); }
      52.1% { transform: translateX(2px); }
      52.3% { transform: translateX(-2px); }
      52.5% { transform: translateX(0); }
    }
    @keyframes glitch-left {
      0%, 50%, 53%, 100% { transform: translateX(0); }
      50.5% { transform: translateX(-10px); }
      50.7% { transform: translateX(10px); }
      50.9% { transform: translateX(-8px); }
      51.1% { transform: translateX(8px); }
      51.3% { transform: translateX(-6px); }
      51.5% { transform: translateX(6px); }
      51.7% { transform: translateX(-4px); }
      51.9% { transform: translateX(4px); }
      52.1% { transform: translateX(-2px); }
      52.3% { transform: translateX(2px); }
      52.5% { transform: translateX(0); }
    }
  </style>
</head>
<body>
  <!-- Each logical line of your ASCII art is wrapped in a <div class="line"> -->
  <div class="line"><pre id="tiresult" style="font-size: 9px; background-color: #000000; font-weight: bold; padding: 4px 5px; --fs: 9px;"><b style=color:#000000>10100111010110111110101001100100110001001101110100</b>
</div>
<div class="line">
<b style=color:#000000>00000110011010100001010010111101101011100111000100</b>
</div>
<div class="line">
<b style=color:#000000>110100001001100011</b><b style=color:#020203>1</b><b style=color:#040507>1</b><b style=color:#000000>000000101110011010111110110101</b>
</div>
<div class="line">
<b style=color:#000000>010101101000011010</b><b style=color:#111116>1</b><b style=color:#624961>0</b><b style=color:#5E4357>0</b><b style=color:#342938>0</b><b style=color:#17141C>0</b><b style=color:#070709>1</b><b style=color:#000000>11111100101111100010110000</b>
</div>
<div class="line">
<b style=color:#000000>101101111110111110</b><b style=color:#080A0D>0</b><b style=color:#745268>0</b><b style=color:#CC8296>1</b><b style=color:#A46A84>0</b><b style=color:#714B67>1</b><b style=color:#3C2C42>0</b><b style=color:#231E2F>0</b><b style=color:#23202B>1</b><b style=color:#211F28>1</b><b style=color:#2E2A38>1</b><b style=color:#363240>1</b><b style=color:#3A3543>1</b><b style=color:#3B3644>0</b><b style=color:#332F3A>0</b><b style=color:#2A2730>1</b><b style=color:#232027>0</b><b style=color:#131216>0</b><b style=color:#080709>0</b><b style=color:#000000>00111111011100</b>
</div>
<div class="line">
<b style=color:#000000>1110100001000111111</b><b style=color:#2F2838>1</b><b style=color:#A66C82>0</b><b style=color:#935B71>0</b><b style=color:#58394F>1</b><b style=color:#3F2E45>0</b><b style=color:#2F283F>1</b><b style=color:#3B354D>1</b><b style=color:#433E57>0</b><b style=color:#45405A>1</b><b style=color:#433F59>1</b><b style=color:#423D57>0</b><b style=color:#423D56>10</b><b style=color:#443F58>1</b><b style=color:#454058>0</b><b style=color:#433E55>0</b><b style=color:#403B50>0</b><b style=color:#373345>0</b><b style=color:#34303D>1</b><b style=color:#36303F>0</b><b style=color:#2D2533>0</b><b style=color:#352532>1</b><b style=color:#402A36>0</b><b style=color:#392A36>0</b><b style=color:#121113>0</b><b style=color:#000000>010010</b>
</div>
<div class="line">
<b style=color:#000000>1011010001100110111</b><b style=color:#0F1013>0</b><b style=color:#46354B>1</b><b style=color:#5B3D55>1</b><b style=color:#312B41>0</b><b style=color:#302D43>0</b><b style=color:#353047>1</b><b style=color:#353048>0</b><b style=color:#363148>1</b><b style=color:#343047>1</b><b style=color:#312E45>1</b><b style=color:#302C43>1</b><b style=color:#302C42>0</b><b style=color:#2E2B41>111</b><b style=color:#2F2B42>0</b><b style=color:#2F2C43>0</b><b style=color:#322E45>1</b><b style=color:#36324A>0</b><b style=color:#3C374F>0</b><b style=color:#453B54>0</b><b style=color:#62455E>1</b><b style=color:#89546B>1</b><b style=color:#47363F>1</b><b style=color:#000000>1100111</b>
</div>
<div class="line">
<b style=color:#000000>0100100010100110001</b><b style=color:#111015>1</b><b style=color:#2A273C>0</b><b style=color:#28263C>1</b><b style=color:#2B293E>1</b><b style=color:#2C293E>1</b><b style=color:#2D293F>1</b><b style=color:#2C293F>0</b><b style=color:#28243A>00</b><b style=color:#373048>0</b><b style=color:#443A53>0</b><b style=color:#3D364E>1</b><b style=color:#312B42>1</b><b style=color:#262238>1</b><b style=color:#272439>00</b><b style=color:#282539>011</b><b style=color:#272439>1</b><b style=color:#28253B>1</b><b style=color:#2F2B43>0</b><b style=color:#453D52>0</b><b style=color:#1F1E23>1</b><b style=color:#000000>1100001</b>
</div>
<div class="line">
<b style=color:#000000>101001110110001101</b><b style=color:#0A090B>1</b><b style=color:#302C40>1</b><b style=color:#2C283E>1</b><b style=color:#2C293E>1</b><b style=color:#2B283D>1</b><b style=color:#29263B>1</b><b style=color:#272439>0</b><b style=color:#222034>1</b><b style=color:#4A4259>0</b><b style=color:#A08CA9>0</b><b style=color:#BAA4C3>1</b><b style=color:#8E80A2>1</b><b style=color:#2D263E>0</b><b style=color:#322E43>1</b><b style=color:#636077>0</b><b style=color:#292439>0</b><b style=color:#211E31>1</b><b style=color:#221F32>011</b><b style=color:#221F33>0</b><b style=color:#232035>0</b><b style=color:#2B273C>0</b><b style=color:#37314A>0</b><b style=color:#39344B>1</b><b style=color:#25232A>0</b><b style=color:#000000>011111</b>
</div>
<div class="line">
<b style=color:#000000>110110010001010000</b><b style=color:#312D3D>0</b><b style=color:#2E2A42>1</b><b style=color:#2B273D>1</b><b style=color:#2A273C>0</b><b style=color:#282539>0</b><b style=color:#262337>1</b><b style=color:#232034>1</b><b style=color:#231F33>0</b><b style=color:#BEADC4>0</b><b style=color:#F8E4FB>0</b><b style=color:#998CA1>1</b><b style=color:#18172D>1</b><b style=color:#060416>0</b><b style=color:#0D0C1E>0</b><b style=color:#2B293C>0</b><b style=color:#42384D>1</b><b style=color:#231F33>1</b><b style=color:#1C1A2D>0</b><b style=color:#1D1A2D>11</b><b style=color:#1E1B2E>1</b><b style=color:#282437>1</b><b style=color:#151123>1</b><b style=color:#504B60>1</b><b style=color:#786B84>0</b><b style=color:#413B4E>0</b><b style=color:#101011>0</b><b style=color:#000000>01000</b>
</div>
<div class="line">
<b style=color:#000000>00100011001100000</b><b style=color:#0F0E12>1</b><b style=color:#342F46>1</b><b style=color:#2A263D>0</b><b style=color:#29263C>0</b><b style=color:#262338>1</b><b style=color:#221F33>0</b><b style=color:#211E31>0</b><b style=color:#201D30>1</b><b style=color:#1C192D>0</b><b style=color:#6E6678>1</b><b style=color:#E4D3E5>1</b><b style=color:#C6B7C7>0</b><b style=color:#483746>0</b><b style=color:#402F3F>1</b><b style=color:#3A2939>0</b><b style=color:#4F394A>1</b><b style=color:#7E687F>1</b><b style=color:#251F34>1</b><b style=color:#1B182B>0</b><b style=color:#1D1A2D>1</b><b style=color:#1D1A2E>1</b><b style=color:#1C192D>0</b><b style=color:#473F52>0</b><b style=color:#191323>1</b><b style=color:#140D1D>1</b><b style=color:#A08F9E>0</b><b style=color:#64596D>1</b><b style=color:#1D1C21>1</b><b style=color:#000000>01101</b>
</div>
<div class="line">
<b style=color:#000000>00100100011111011</b><b style=color:#131216>0</b><b style=color:#272439>1</b><b style=color:#232034>1</b><b style=color:#28253A>1</b><b style=color:#242135>0</b><b style=color:#201D30>0</b><b style=color:#1F1C2F>00</b><b style=color:#1E1B2E>1</b><b style=color:#171528>0</b><b style=color:#353043>0</b><b style=color:#71687A>1</b><b style=color:#7D7180>0</b><b style=color:#695667>1</b><b style=color:#5F4B5C>0</b><b style=color:#5F4D62>0</b><b style=color:#41384E>1</b><b style=color:#232034>0</b><b style=color:#272337>0</b><b style=color:#262337>1</b><b style=color:#201D30>1</b><b style=color:#1E1C2F>1</b><b style=color:#453E52>1</b><b style=color:#604F62>1</b><b style=color:#715D70>1</b><b style=color:#9D8FA2>1</b><b style=color:#3A3449>1</b><b style=color:#373441>0</b><b style=color:#000000>01001</b>
</div>
<div class="line">
<b style=color:#000000>00001111000010010</b><b style=color:#0B0A0C>1</b><b style=color:#221F32>1</b><b style=color:#1A172A>1</b><b style=color:#1C192D>1</b><b style=color:#1F1C2F>001</b><b style=color:#1E1B2E>0</b><b style=color:#1D1A2D>10</b><b style=color:#19162A>0</b><b style=color:#171428>0</b><b style=color:#1B182C>1</b><b style=color:#201D31>0</b><b style=color:#211D31>1</b><b style=color:#1E1B2F>1</b><b style=color:#1D1A2E>0</b><b style=color:#201D30>00</b><b style=color:#1E1B2F>0</b><b style=color:#1B182B>1</b><b style=color:#1F1C30>0</b><b style=color:#1D1B2E>1</b><b style=color:#232034>1</b><b style=color:#2F2B40>1</b><b style=color:#262337>1</b><b style=color:#272339>0</b><b style=color:#4B4556>0</b><b style=color:#010101>1</b><b style=color:#000000>1010</b>
</div>
<div class="line">
<b style=color:#000000>111101000111010</b><b style=color:#020202>1</b><b style=color:#100F15>0</b><b style=color:#191624>0</b><b style=color:#191629>0</b><b style=color:#1B182B>1</b><b style=color:#1B172B>0</b><b style=color:#191629>111011</b><b style=color:#1A1729>0</b><b style=color:#1A172A>01</b><b style=color:#1A1629>11</b><b style=color:#191629>101</b><b style=color:#1A172A>1</b><b style=color:#191629>11</b><b style=color:#1A172A>0</b><b style=color:#1B182B>1</b><b style=color:#1C192C>1</b><b style=color:#1E1B2F>0</b><b style=color:#231F35>1</b><b style=color:#383148>0</b><b style=color:#35313A>0</b><b style=color:#000000>01001</b>
</div>
<div class="line">
<b style=color:#000000>1110000011000</b><b style=color:#040404>0</b><b style=color:#18171F>0</b><b style=color:#272334>0</b><b style=color:#272438>0</b><b style=color:#1F1B2F>0</b><b style=color:#181528>0</b><b style=color:#161325>0</b><b style=color:#181527>1</b><b style=color:#1B182A>1</b><b style=color:#1C192C>1</b><b style=color:#1A172A>0</b><b style=color:#181528>0</b><b style=color:#171327>1</b><b style=color:#151224>0</b><b style=color:#131021>1</b><b style=color:#120F20>0</b><b style=color:#110E1F>010</b><b style=color:#120F20>01</b><b style=color:#131021>1</b><b style=color:#141123>1</b><b style=color:#151224>01</b><b style=color:#161325>0</b><b style=color:#151225>0</b><b style=color:#19162A>1</b><b style=color:#252135>1</b><b style=color:#302C3C>1</b><b style=color:#221F25>0</b><b style=color:#000000>010011</b>
</div>
<div class="line">
<b style=color:#000000>000010011101</b><b style=color:#121116>0</b><b style=color:#2B2738>0</b><b style=color:#2F2A41>1</b><b style=color:#2A263C>1</b><b style=color:#242135>0</b><b style=color:#201D30>0</b><b style=color:#1A172A>0</b><b style=color:#161326>1</b><b style=color:#151224>1</b><b style=color:#141122>1</b><b style=color:#141123>0</b><b style=color:#151223>1</b><b style=color:#161325>0</b><b style=color:#181527>0</b><b style=color:#171426>0</b><b style=color:#151224>0</b><b style=color:#131022>0</b><b style=color:#120F20>1</b><b style=color:#110E1F>011001</b><b style=color:#120F20>1</b><b style=color:#120F21>0</b><b style=color:#141023>0</b><b style=color:#1F1C2D>1</b><b style=color:#24222D>1</b><b style=color:#1B191E>0</b><b style=color:#060606>1</b><b style=color:#000000>1010100</b>
</div>
<div class="line">
<b style=color:#000000>11110110000</b><b style=color:#1B1922>0</b><b style=color:#2E293E>1</b><b style=color:#29253B>0</b><b style=color:#282439>0</b><b style=color:#252135>1</b><b style=color:#211E31>0</b><b style=color:#201D30>0</b><b style=color:#1D1A2D>0</b><b style=color:#181528>0</b><b style=color:#151224>0</b><b style=color:#141123>1</b><b style=color:#141021>0</b><b style=color:#131021>1</b><b style=color:#110E1F>0</b><b style=color:#100D1E>1</b><b style=color:#0E0B1C>01</b><b style=color:#0D0A1B>1</b><b style=color:#0C0A1B>1</b><b style=color:#0C091A>0</b><b style=color:#0D0A1B>00</b><b style=color:#0E0B1C>0</b><b style=color:#0F0C1D>00</b><b style=color:#100D1F>0</b><b style=color:#141123>0</b><b style=color:#2C283B>1</b><b style=color:#1E1D21>0</b><b style=color:#000000>0111011101</b>
</div>
<div class="line">
<b style=color:#000000>11</b><b style=color:#060608>1</b><b style=color:#13121A>0</b><b style=color:#1B1824>1</b><b style=color:#1D1B26>0</b><b style=color:#131217>1</b><b style=color:#010101>1</b><b style=color:#000000>10</b><b style=color:#131218>1</b><b style=color:#222033>0</b><b style=color:#1F1D31>1</b><b style=color:#1F1D30>1</b><b style=color:#1E1C2E>1</b><b style=color:#1A182A>1</b><b style=color:#19172A>0</b><b style=color:#1B1A2C>0</b><b style=color:#1C1A2C>0</b><b style=color:#191729>1</b><b style=color:#151325>1</b><b style=color:#131123>1</b><b style=color:#131022>01</b><b style=color:#120F21>1</b><b style=color:#110E20>1</b><b style=color:#0F0C1E>1</b><b style=color:#0E0B1C>1</b><b style=color:#0C091A>1</b><b style=color:#0B0819>0</b><b style=color:#0A0818>11</b><b style=color:#0B0919>1</b><b style=color:#0D0A1B>0</b><b style=color:#0F0D1F>1</b><b style=color:#141124>0</b><b style=color:#19172A>0</b><b style=color:#19162A>1</b><b style=color:#302C42>1</b><b style=color:#36333B>1</b><b style=color:#000000>1111101110</b>
</div>
<div class="line">
<b style=color:#000000>0</b><b style=color:#070708>0</b><b style=color:#1F1C2B>0</b><b style=color:#151325>0</b><b style=color:#131122>1</b><b style=color:#161527>0</b><b style=color:#292536>0</b><b style=color:#151316>1</b><b style=color:#000000>01</b><b style=color:#1A1826>0</b><b style=color:#141325>0</b><b style=color:#181729>01</b><b style=color:#161527>1</b><b style=color:#131223>1</b><b style=color:#0F0E20>1</b><b style=color:#131224>1</b><b style=color:#181729>11</b><b style=color:#171629>1</b><b style=color:#151427>0</b><b style=color:#141225>0</b><b style=color:#141124>0</b><b style=color:#131023>0</b><b style=color:#121021>0</b><b style=color:#110F21>1</b><b style=color:#100E20>1</b><b style=color:#0F0D1E>0</b><b style=color:#0E0C1D>001</b><b style=color:#0E0D1E>1</b><b style=color:#121022>0</b><b style=color:#181729>0</b><b style=color:#1F1D31>1</b><b style=color:#19182B>0</b><b style=color:#121124>0</b><b style=color:#26233A>0</b><b style=color:#565261>1</b><b style=color:#000000>1011111100</b>
</div>
<div class="line">
<b style=color:#000000>1</b><b style=color:#09090A>1</b><b style=color:#191726>1</b><b style=color:#0A0919>1</b><b style=color:#211F2A>0</b><b style=color:#16161B>0</b><b style=color:#111014>1</b><b style=color:#030303>1</b><b style=color:#000000>01</b><b style=color:#141320>1</b><b style=color:#0D0D1D>1</b><b style=color:#131222>1</b><b style=color:#161527>1</b><b style=color:#171628>0</b><b style=color:#151426>0</b><b style=color:#111021>0</b><b style=color:#0D0C1C>1</b><b style=color:#0D0C1D>0</b><b style=color:#100F21>1</b><b style=color:#131224>1</b><b style=color:#141325>1</b><b style=color:#141225>1</b><b style=color:#151426>1</b><b style=color:#141225>1</b><b style=color:#131123>0</b><b style=color:#121022>1</b><b style=color:#110F21>0</b><b style=color:#110F20>1</b><b style=color:#100E20>1</b><b style=color:#0F0E20>1</b><b style=color:#100E20>0</b><b style=color:#121224>1</b><b style=color:#171629>0</b><b style=color:#161527>0</b><b style=color:#111022>0</b><b style=color:#100F21>0</b><b style=color:#151427>1</b><b style=color:#2B2840>1</b><b style=color:#585463>1</b><b style=color:#000000>0000001011</b>
</div>
<div class="line">
<b style=color:#000000>01</b><b style=color:#1A1822>0</b><b style=color:#0D0C1C>1</b><b style=color:#10101E>0</b><b style=color:#17171D>0</b><b style=color:#040404>0</b><b style=color:#000000>011</b><b style=color:#10101A>1</b><b style=color:#070819>0</b><b style=color:#0A0A1A>1</b><b style=color:#0D0C1E>0</b><b style=color:#111022>0</b><b style=color:#121123>11</b><b style=color:#100F21>1</b><b style=color:#0D0C1D>1</b><b style=color:#0B0A1B>0</b><b style=color:#09081A>0</b><b style=color:#0A091B>0</b><b style=color:#100F21>0</b><b style=color:#111022>0</b><b style=color:#0D0B1C>1</b><b style=color:#121123>1</b><b style=color:#121022>1</b><b style=color:#110F21>011</b><b style=color:#100F21>0</b><b style=color:#0F0E20>1</b><b style=color:#111021>0</b><b style=color:#0F0E20>0</b><b style=color:#0D0C1E>1</b><b style=color:#100E20>1</b><b style=color:#111022>1</b><b style=color:#171628>1</b><b style=color:#39364E>0</b><b style=color:#45434B>0</b><b style=color:#000000>0110001001</b>
</div>
<div class="line">
<b style=color:#000000>00</b><b style=color:#070708>0</b><b style=color:#1A1925>1</b><b style=color:#090A1A>0</b><b style=color:#080919>0</b><b style=color:#12121F>1</b><b style=color:#12111A>1</b><b style=color:#0D0D11>0</b><b style=color:#050506>1</b><b style=color:#12121A>1</b><b style=color:#09091C>1</b><b style=color:#050517>11</b><b style=color:#060618>1</b><b style=color:#080719>1</b><b style=color:#09081B>1</b><b style=color:#0A091A>0</b><b style=color:#0A0919>0</b><b style=color:#09081A>00</b><b style=color:#0B0A1C>0</b><b style=color:#0B0B1C>0</b><b style=color:#040415>1</b><b style=color:#020213>1</b><b style=color:#0A091B>1</b><b style=color:#111022>011</b><b style=color:#111020>1</b><b style=color:#111021>1</b><b style=color:#111022>1</b><b style=color:#100F21>0</b><b style=color:#0E0D1F>0</b><b style=color:#0F0E20>0</b><b style=color:#111022>0</b><b style=color:#141326>1</b><b style=color:#1C1A2F>0</b><b style=color:#4A475D>1</b><b style=color:#222224>0</b><b style=color:#000000>1101010100</b>
</div>
<div class="line">
<b style=color:#000000>111</b><b style=color:#050505>1</b><b style=color:#13121A>0</b><b style=color:#0F0F1C>0</b><b style=color:#070717>0</b><b style=color:#040615>0</b><b style=color:#070817>0</b><b style=color:#080916>1</b><b style=color:#090A18>0</b><b style=color:#0B0C1D>1</b><b style=color:#08071A>0</b><b style=color:#040417>1</b><b style=color:#030315>0</b><b style=color:#030215>11</b><b style=color:#040314>1</b><b style=color:#040315>01</b><b style=color:#050416>10</b><b style=color:#040415>1</b><b style=color:#030416>1</b><b style=color:#050517>00</b><b style=color:#080819>0</b><b style=color:#0F0E20>1</b><b style=color:#0F0E21>1</b><b style=color:#100E21>1</b><b style=color:#131125>1</b><b style=color:#16162A>0</b><b style=color:#19182C>0</b><b style=color:#1B1A2E>0</b><b style=color:#121124>1</b><b style=color:#111022>1</b><b style=color:#1C1A30>1</b><b style=color:#302D44>0</b><b style=color:#524E65>1</b><b style=color:#252428>1</b><b style=color:#000000>1110001001</b>
</div>
<div class="line">
<b style=color:#000000>00000</b><b style=color:#050405>1</b><b style=color:#09090C>1</b><b style=color:#0B0B10>1</b><b style=color:#0A0A11>0</b><b style=color:#090912>1</b><b style=color:#090711>1</b><b style=color:#0B0B15>1</b><b style=color:#100F1C>0</b><b style=color:#0D0D1C>1</b><b style=color:#0A0A1A>1</b><b style=color:#090919>1</b><b style=color:#080718>0</b><b style=color:#080819>0</b><b style=color:#09081A>1</b><b style=color:#090819>0</b><b style=color:#0A091A>0</b><b style=color:#09091A>1</b><b style=color:#0A091B>1</b><b style=color:#0B0A1B>1</b><b style=color:#0B0A1C>0</b><b style=color:#0B0B1D>1</b><b style=color:#080919>1</b><b style=color:#09091B>0</b><b style=color:#0F0E1F>0</b><b style=color:#100F20>0</b><b style=color:#121122>1</b><b style=color:#141325>00</b><b style=color:#1B1A2C>0</b><b style=color:#1C1A2A>0</b><b style=color:#121120>1</b><b style=color:#161525>1</b><b style=color:#1B1929>0</b><b style=color:#2C2A3A>1</b><b style=color:#201F23>1</b><b style=color:#000000>0110111110</b>
</div>
<div class="line">
<b style=color:#000000>000111101001</b><b style=color:#030303>0</b><b style=color:#040404>0</b><b style=color:#050506>1</b><b style=color:#060608>1</b><b style=color:#070709>1</b><b style=color:#09090B>1</b><b style=color:#0A0A0D>1</b><b style=color:#08080B>0</b><b style=color:#09090D>1</b><b style=color:#0A0A0D>0</b><b style=color:#0B0B0E>110</b><b style=color:#0C0C0F>0</b><b style=color:#0A090D>0</b><b style=color:#08080B>10</b><b style=color:#09080C>1</b><b style=color:#0A0A0D>0</b><b style=color:#0C0B0E>0</b><b style=color:#09090B>0</b><b style=color:#09080A>1</b><b style=color:#060607>1</b><b style=color:#050505>100</b><b style=color:#030302>1</b><b style=color:#000000>11011010010</b>
</div>
  </pre>
</body>
</html>

    </div>
    
    <!-- Narrative text area -->
    <div id="text"></div>
    <!-- Choices display -->
    <div id="choices"></div>
    <!-- Input container for player's command -->
    <div id="input-container">
      <span id="prompt">&gt;</span>
      <input type="text" id="command-input" autocomplete="off" />
    </div>
  </div>

  <script>
    /***** Global State *****/
    let state = {
      hasArtifact: false,
      journalWritten: false
    };

    // Holds the current list of choices for input validation.
    let currentChoices = [];

    /***** Typing Sound Setup *****
     * Ensure you have a file named "typing.mp3" in the same folder,
     * or update the URL accordingly.
     * Volume is set low (0.1) for a subtle effect.
     */
    var typingSound = new Audio('typing.mp3');
    typingSound.volume = 0.1;
    function playTypingSound() {
      // Clone the sound so overlapping plays are possible.
      var sound = typingSound.cloneNode();
      sound.volume = 0.1;
      sound.play();
    }

    /***** Scene Definitions *****
     * Each scene includes:
     *   - text: narrative content
     *   - choices: an array of { option: "Choice text", next: "sceneId" }
     *   - (optionally) effect: a function to update state
     *   - (optionally) end: true if terminal
     */
    const scenes = {
      "intro": {
        text: "You awaken in a realm of shadow and whispers...\n\nA long-forgotten legend tells of a crypt hidden beneath an ancient castle, a library filled with secrets, and a tapestry that conceals mysteries beyond mortal ken.\n\nWill you dare to embark on this labyrinthine quest?",
        choices: [
          { option: "Venture into the dark crypt.", next: "crypt_entrance" },
          { option: "Explore the mysterious library.", next: "library" },
          { option: "Examine the ancient tapestry.", next: "tapestry" }
        ]
      },
      "crypt_entrance": {
        text: "Standing before the heavy, iron-bound entrance of the crypt, a chill runs down your spine.\nThe darkness beckons with promises of danger and secret lore.",
        choices: [
          { option: "Descend into the catacombs.", next: "catacombs" },
          { option: "Search for hidden passages along the walls.", next: "hidden_crypt" },
          { option: "Step back to reconsider your journey.", next: "intro" }
        ]
      },
      "catacombs": {
        text: "In the winding catacombs, faint whispers and distant echoes create an unsettling atmosphere.\nStrange inscriptions and eerie sounds surround you.",
        choices: [
          { option: "Investigate the unsettling sounds.", next: "ghost_encounter" },
          { option: "Examine the mysterious inscriptions on the walls.", next: "crypt_inscriptions" },
          { option: "Press onward deeper into the darkness.", next: "crypt_deeper" }
        ]
      },
      "hidden_crypt": {
        text: "A narrow corridor reveals a hidden section of the crypt, where shadows conceal many secrets.",
        choices: [
          { option: "Pull a suspicious lever embedded in the wall.", next: "secret_door" },
          { option: "Examine an ornate chest tucked in the corner.", next: "ornate_chest" },
          { option: "Search the floor meticulously for traps.", next: "crypt_traps" }
        ]
      },
      "ghost_encounter": {
        text: "A translucent figure materializes before youâ€”a ghost filled with sorrow and ancient regret.",
        choices: [
          { option: "Attempt to communicate with the spirit.", next: "ghost_talk" },
          { option: "Flee in terror through the winding tunnels.", next: "crypt_flee" },
          { option: "Defend yourself with any weapon you possess.", next: "ghost_fight" }
        ]
      },
      "crypt_inscriptions": {
        text: "The inscriptions speak of a relic lost in time and a path known only to the brave.\nMysteries beckon from every symbol.",
        choices: [
          { option: "Decipher the cryptic symbols carefully.", next: "decipher_symbols" },
          { option: "Ignore the markings and move deeper.", next: "crypt_deeper" },
          { option: "Record the inscriptions in your journal.", next: "journal_record" }
        ]
      },
      "crypt_deeper": {
        text: "Deeper in the crypt, you enter a chamber pulsing with a mysterious energy.\nThe air grows colder, and your heart beats faster.",
        choices: [
          { option: "Enter the chamber illuminated by glowing runes.", next: "rune_chamber" },
          { option: "Follow the sound of echoing water droplets.", next: "water_chamber" },
          { option: "Climb a narrow, creaking set of stairs.", next: "narrow_stairs" }
        ]
      },
      "secret_door": {
        text: "The lever clicks, and a hidden door groans open to reveal a room glittering with treasures and secrets.",
        choices: [
          { option: "Step into the treasure room with cautious hope.", next: "treasure_room" },
          { option: "Search the room for clues about the doorâ€™s mechanism.", next: "door_clues" },
          { option: "Decide to leave quietly and return.", next: "crypt_entrance" }
        ]
      },
      "ornate_chest": {
        text: "The chest is masterfully carved and sealed. Within, you sense a mysterious artifact awaits.",
        choices: [
          { option: "Retrieve the artifact hidden inside.", next: "artifact_taken" },
          { option: "Inspect the chest for any deadly traps.", next: "chest_inspect" },
          { option: "Leave the chest undisturbed and explore elsewhere.", next: "hidden_crypt" }
        ]
      },
      "crypt_traps": {
        text: "Carefully scanning the floor, you notice an intricate network of traps designed to ensnare the unwary.",
        choices: [
          { option: "Attempt to disarm the trap with steady hands.", next: "trap_disarmed" },
          { option: "Carefully avoid the trap by stepping aside.", next: "trap_avoided" },
          { option: "Trigger the trap deliberately to test its mechanism.", next: "trap_triggered" }
        ]
      },
      "ghost_talk": {
        text: "The ghostâ€™s voice trembles as it utters a cryptic message: \"Seek the wisdom hidden within the library, and the relic lies behind the tapestry...\"",
        choices: [
          { option: "Thank the ghost and head to the secret door.", next: "secret_door" },
          { option: "Ask for more details about its message.", next: "ghost_more" },
          { option: "Dismiss the apparition and return to the crypt entrance.", next: "crypt_entrance" }
        ]
      },
      "crypt_flee": {
        text: "In a panicked dash through twisting tunnels, you soon find yourself hopelessly lost among the dark passages.",
        choices: [
          { option: "Try to retrace your steps back to the entrance.", next: "crypt_entrance" },
          { option: "Keep running forward into the unknown.", next: "narrow_stairs" },
          { option: "Find a quiet corner to hide and catch your breath.", next: "trap_avoided" }
        ]
      },
      "ghost_fight": {
        text: "You lunge forward, attempting to fight the spectral foe. Yet, the ghostâ€™s ethereal form eludes your attacks,\nand your courage begins to falter.",
        choices: [
          { option: "Regroup and try a different approach.", next: "crypt_entrance" },
          { option: "Surrender to the overwhelming force.", next: "game_over" },
          { option: "Attempt a risky maneuver in desperation.", next: "ghost_talk" }
        ]
      },
      "decipher_symbols": {
        text: "The symbols unravel before your eyes, hinting at a hidden relic and an ancient power residing deep within the crypt.",
        choices: [
          { option: "Follow the trail into the rune chamber.", next: "rune_chamber" },
          { option: "Search further in the catacombs for the relic.", next: "crypt_deeper" },
          { option: "Return to the castle entrance to gather your thoughts.", next: "intro" }
        ]
      },
      "journal_record": {
        text: "You carefully record the inscriptions in your journal, hoping that this ancient knowledge will guide you later.",
        choices: [
          { option: "Venture deeper into the crypt.", next: "crypt_deeper" },
          { option: "Seek more answers in the mysterious library.", next: "library" },
          { option: "Take a moment to rest and reflect on what youâ€™ve learned.", next: "game_over" }
        ],
        effect: function() { state.journalWritten = true; }
      },
      "rune_chamber": {
        text: "Bathed in a ghostly glow, the rune chamber vibrates with an otherworldly energy.\nA sense of destiny hints that the relicâ€™s location is near.",
        choices: [
          { option: "Follow the glowing runes to the treasure.", next: "treasure_room" },
          { option: "Detour toward the chamber of echoing water.", next: "water_chamber" },
          { option: "Return to the mysterious catacombs.", next: "catacombs" }
        ]
      },
      "water_chamber": {
        text: "In a cavern filled with dripping water and reflective pools, the ripples reveal hidden symbols\nand patterns that seem to guide your next step.",
        choices: [
          { option: "Examine the reflected symbols carefully.", next: "decipher_symbols" },
          { option: "Search the room for a secret passage.", next: "narrow_stairs" },
          { option: "Quickly leave the unsettling chamber.", next: "crypt_entrance" }
        ]
      },
      "narrow_stairs": {
        text: "The narrow, creaking stairs lead you upward through a forgotten corridor.\nEvery step feels fraught with danger and mystery.",
        choices: [
          { option: "Proceed upward with extreme caution.", next: "library" },
          { option: "Stop to examine your surroundings for clues.", next: "tapestry_study" },
          { option: "Hasten your steps back to the safety of the crypt entrance.", next: "crypt_entrance" }
        ]
      },
      "door_clues": {
        text: "Scrutinizing the area, you discover a series of symbols and a hidden switchâ€”a clue to the doorâ€™s mechanism.",
        choices: [
          { option: "Use the clues to unlock the door.", next: "treasure_room" },
          { option: "Ignore the clues and attempt to force the door open.", next: "game_over" },
          { option: "Search further for additional hints.", next: "secret_door" }
        ]
      },
      "treasure_room": {
        text: "You step into a dazzling treasure room filled with relics, gold, and ancient secrets.\nIn the center, the relic you have long sought radiates with mystical power.\n\nCongratulations! You have uncovered the cryptâ€™s greatest secret and changed your destiny!",
        choices: [],
        end: true
      },
      "artifact_taken": {
        text: "The mysterious artifact pulses with a strange energy. It might be the relic spoken of in legends.",
        choices: [
          { option: "Keep the artifact and head to the library for guidance.", next: "library" },
          { option: "Try using the artifact on the crypt door.", next: "door_clues" },
          { option: "Examine the artifact more closely.", next: "chest_inspect" }
        ],
        effect: function() { state.hasArtifact = true; }
      },
      "chest_inspect": {
        text: "A closer inspection of the chest reveals ancient inscriptions that hint at a hidden passage in the library.",
        choices: [
          { option: "Return to the library with this newfound knowledge.", next: "library" },
          { option: "Attempt to force the chest open.", next: "game_over" },
          { option: "Ignore the chest and resume exploring the crypt.", next: "crypt_entrance" }
        ]
      },
      "trap_disarmed": {
        text: "With nimble fingers and nerves of steel, you disarm the trapâ€”paving a safe path deeper into the crypt.",
        choices: [
          { option: "Continue your journey into the crypt.", next: "crypt_deeper" },
          { option: "Return cautiously to the crypt entrance.", next: "crypt_entrance" },
          { option: "Investigate the disarmed trap for further clues.", next: "hidden_crypt" }
        ]
      },
      "trap_avoided": {
        text: "You narrowly avoid the trap, your heart pounding at the close call.",
        choices: [
          { option: "Proceed carefully into the crypt.", next: "crypt_deeper" },
          { option: "Backtrack to the safety of the crypt entrance.", next: "crypt_entrance" },
          { option: "Study the trapâ€™s mechanism for hidden secrets.", next: "crypt_traps" }
        ]
      },
      "trap_triggered": {
        text: "As you trigger the trap, a burst of searing energy overwhelms you.\nYour strength fades into darkness...\n\nGame Over.",
        choices: [],
        end: true
      },
      "library": {
        text: "You enter an ancient library filled with towering bookshelves, dusty scrolls, and whispered lore.\nEvery shadow seems to conceal a secret waiting to be discovered.",
        choices: [
          { option: "Browse through a collection of ancient scrolls.", next: "scrolls" },
          { option: "Search for hidden compartments among the shelves.", next: "secret_compartment" },
          { option: "Consult with a mysterious, wise librarian.", next: "librarian" }
        ]
      },
      "tapestry": {
        text: "An enormous, faded tapestry hangs on the wall. Its intricate designs and obscure figures hint at a long-forgotten tale.",
        choices: [
          { option: "Study the images and symbols in the tapestry.", next: "tapestry_study" },
          { option: "Carefully lift the tapestry to see what lies behind it.", next: "tapestry_secret" },
          { option: "Attempt to restore its faded colors with gentle care.", next: "tapestry_restore" }
        ]
      },
      "scrolls": {
        text: "The ancient scrolls contain maps, cryptic riddles, and the lore of this forsaken place.\nEvery word hints at hidden paths and dangerous truths.",
        choices: [
          { option: "Study the maps and riddles intently.", next: "librarian" },
          { option: "Memorize key details and store them in your mind.", next: "librarian" },
          { option: "Copy the scrollsâ€™ secrets into your journal.", next: "journal_record" }
        ]
      },
      "secret_compartment": {
        text: "Behind a row of dusty tomes, you discover a secret compartment tucked away.\nIts contents could be the key to unraveling the mysteries here.",
        choices: [
          { option: "Open the compartment to reveal its contents.", next: "scrolls" },
          { option: "Leave the compartment undisturbed.", next: "library" },
          { option: "Examine the surrounding area for further clues.", next: "librarian" }
        ]
      },
      "librarian": {
        text: "A wizened librarian materializes from the shadows, offering cryptic advice and guidance.\nHer eyes glimmer with the secrets of ages past.",
        choices: [
          { option: "Listen intently to her advice.", next: "tapestry_study" },
          { option: "Inquire about the relic mentioned in legends.", next: "artifact_taken" },
          { option: "Ask about the secret compartments in the library.", next: "secret_compartment" }
        ]
      },
      "tapestry_study": {
        text: "Studying the tapestry, you decipher a hidden narrative of heroes, treachery, and lost relics.\nThe clues hint at a concealed path behind the woven threads.",
        choices: [
          { option: "Follow the hints to discover a secret passage.", next: "tapestry_secret" },
          { option: "Set aside the tapestry and continue exploring the library.", next: "library" },
          { option: "Attempt to restore the tapestry to its former glory.", next: "tapestry_restore" }
        ]
      },
      "tapestry_secret": {
        text: "Behind the tapestry, a concealed door leads into a dimly lit mystical chamber filled with magic and mystery.",
        choices: [
          { option: "Enter the mystical chamber with determination.", next: "mystical_chamber" },
          { option: "Return to the library to gather more clues.", next: "library" },
          { option: "Search the area for further hidden secrets.", next: "tapestry_study" }
        ]
      },
      "tapestry_restore": {
        text: "As you carefully restore the faded colors of the tapestry, hidden symbols emergeâ€”revealing a new passage and a glimmer of destiny.",
        choices: [
          { option: "Step into the newly revealed passage.", next: "mystical_chamber" },
          { option: "Save your work and return to the library.", next: "library" },
          { option: "Ignore the passage and scrutinize the room further.", next: "librarian" }
        ]
      },
      "mystical_chamber": {
        text: "In the mystical chamber, the air vibrates with ancient power and magic. You feel the relicâ€™s energy pulsing all around you.\n\nCongratulations! You have uncovered the ultimate secret and harnessed the power of the ancients!",
        choices: [],
        end: true
      },
      "ghost_more": {
        text: "The ghostâ€™s voice grows softer yet clearer: \"Seek wisdom in the library and let the tapestry reveal what is hidden.\"",
        choices: [
          { option: "Head to the library immediately.", next: "library" },
          { option: "Examine the tapestry for hidden messages.", next: "tapestry" },
          { option: "Return to the crypt entrance to reconsider.", next: "crypt_entrance" }
        ]
      },
      "game_over": {
        text: "Fate has not smiled upon you this time...\n\nGame Over.",
        choices: [],
        end: true
      }
    };

    /***** Utility: Animate Text Slowly *****
     * Displays the given text one character at a time in the target element.
     * Calls callback() when finished.
     */
    function typeText(text, targetElement, callback) {
      targetElement.innerHTML = ""; // Clear previous text
      let i = 0;
      const interval = setInterval(() => {
        if (i < text.length) {
          const char = text.charAt(i);
          targetElement.innerHTML += char;
          if (char !== " " && char !== "\n") {
            playTypingSound();
          }
          i++;
        } else {
          clearInterval(interval);
          if (callback) callback();
        }
      }, 40 + Math.random() * 30);
    }

    // Animate the choices text slowly (using typeText)
    function animateChoices(choices, callback) {
      currentChoices = choices; // Update current choices for input handling
      const choicesDiv = document.getElementById("choices");
      let combinedText = "";
      if (choices.length === 0) {
        combinedText = "\n[Press Enter to restart]";
      } else {
        choices.forEach((choice, index) => {
          combinedText += `${index + 1}. ${choice.option}\n`;
        });
        combinedText += "\nType the number of your choice and press Enter.";
      }
      typeText(combinedText, choicesDiv, () => {
        // After animating choices, show and focus the input field.
        document.getElementById("input-container").style.display = "flex";
        document.getElementById("command-input").value = "";
        document.getElementById("command-input").focus();
        if (callback) callback();
      });
    }

    /***** Main: Display a Scene *****
     * Clears the screen, animates scene text (and runs any state effect),
     * then animates available choices.
     */
    function displayScene(sceneId) {
      // Hide the input container during text animation.
      document.getElementById("input-container").style.display = "none";
      const scene = scenes[sceneId];
      if (scene.effect) scene.effect();
      const textDiv = document.getElementById("text");
      typeText(scene.text, textDiv, () => {
        if (scene.end || scene.choices.length === 0) {
          animateChoices([]);
        } else {
          animateChoices(scene.choices);
        }
      });
    }

    /***** Handle Player Input *****
     * When the player types a choice and presses Enter, validate the input and proceed.
     */
    document.getElementById("command-input").addEventListener("keydown", function(event) {
      if (event.key === "Enter") {
        const inputVal = this.value.trim();
        if (currentChoices.length === 0) {
          startGame();
          return;
        }
        const choiceNum = parseInt(inputVal, 10);
        if (!isNaN(choiceNum) && choiceNum >= 1 && choiceNum <= currentChoices.length) {
          const nextScene = currentChoices[choiceNum - 1].next;
          displayScene(nextScene);
        } else {
          this.value = "";
        }
      }
    });

    /***** Particle Effect on Container Border *****/
    const canvas = document.getElementById("particleCanvas");
    const ctx = canvas.getContext("2d");
    let particles = [];
    function resizeCanvas() {
      canvas.width = canvas.offsetWidth;
      canvas.height = canvas.offsetHeight;
    }
    window.addEventListener('resize', resizeCanvas);
    resizeCanvas();
    function spawnParticle() {
      let border = Math.floor(Math.random() * 4);
      let x, y;
      if (border === 0) { // top
        x = Math.random() * canvas.width;
        y = 0;
      } else if (border === 1) { // right
        x = canvas.width;
        y = Math.random() * canvas.height;
      } else if (border === 2) { // bottom
        x = Math.random() * canvas.width;
        y = canvas.height;
      } else { // left
        x = 0;
        y = Math.random() * canvas.height;
      }
      let angle = Math.random() * Math.PI * 2;
      let speed = Math.random() * 0.5 + 0.5;
      let vx = Math.cos(angle) * speed;
      let vy = Math.sin(angle) * speed;
      particles.push({ x, y, vx, vy, alpha: 1, lifetime: Math.random() * 60 + 60 });
    }
    function updateParticles() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      for (let i = 0; i < 3; i++) {
        spawnParticle();
      }
      particles.forEach((p, index) => {
        p.x += p.vx;
        p.y += p.vy;
        p.lifetime--;
        p.alpha = p.lifetime / 120;
        ctx.fillStyle = `rgba(128,0,128,${p.alpha})`; // purple particles
        ctx.beginPath();
        ctx.arc(p.x, p.y, 2, 0, Math.PI * 2);
        ctx.fill();
        if (p.lifetime <= 0) {
          particles.splice(index, 1);
        }
      });
      requestAnimationFrame(updateParticles);
    }
    updateParticles();

    /***** Start / Restart the Game *****/
    function startGame() {
      state = { hasArtifact: false, journalWritten: false };
      displayScene("intro");
    }

    // Begin the game when the page loads.
    window.onload = startGame;
  </script>
</body>
</html>
